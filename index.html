<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ğŸº ìˆ  ì§€ì¶œ ì—­ì „ ê³„ì‚°ê¸° | ë‚´ ìˆ ê°’ì´ ë¯¸ë˜ë¥¼ ì´ê²¼ë‹¤</title>
    <meta
      name="description"
      content="í•œ ë‹¬ ìˆ ìë¦¬ íšŸìˆ˜ì™€ 1íšŒ ì§€ì¶œë§Œ ì…ë ¥í•˜ë©´, ì§€ê¸ˆê¹Œì§€ ìˆ ê°’ ì´ì•¡ê³¼ íˆ¬ìí–ˆì„ ë•Œì˜ ê¸ˆì•¡(ë³µë¦¬)ì„ ë°”ë¡œ ë³´ì—¬ë“œë¦½ë‹ˆë‹¤."
    />

    <!-- OG -->
    <meta property="og:title" content="ğŸº ìˆ  ì§€ì¶œ ì—­ì „ ê³„ì‚°ê¸°" />
    <meta
      property="og:description"
      content="ë‚´ ìˆ ê°’ ì´ì•¡ vs íˆ¬ìí–ˆë‹¤ë©´? 10ì´ˆ ë§Œì— ì—­ì „ ìˆ˜ì¹˜ ë½‘ê¸°"
    />
    <meta
      property="og:image"
      content="https://dummyimage.com/1200x630/0f172a/ffffff&text=%F0%9F%8D%BA%20%EC%88%A0%20%EC%A7%80%EC%B6%9C%20%EC%97%AD%EC%A0%84%20%EA%B3%84%EC%82%B0%EA%B8%B0"
    />
    <meta property="og:image:alt" content="ìˆ  ì§€ì¶œ ì—­ì „ ê³„ì‚°ê¸° ì¸ë„¤ì¼" />
    <meta property="og:type" content="website" />

    <!-- Tailwind CDN -->
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
      /* ì‚´ì§ ë” ì˜ˆì˜ê²Œ */
      .glass {
        background: rgba(255, 255, 255, 0.72);
        backdrop-filter: blur(10px);
      }
    </style>
  </head>

  <body
    class="min-h-screen bg-gradient-to-b from-slate-900 via-slate-900 to-slate-950 text-slate-100"
  >
    <main class="mx-auto max-w-3xl px-4 py-10">
      <header class="mb-8">
        <div
          class="inline-flex items-center gap-2 rounded-full bg-white/10 px-3 py-1 text-sm text-slate-200"
        >
          <span>ğŸº</span><span>ì¬ë¯¸ìš© Â· ì°¸ê³ ìš©</span>
        </div>
        <h1 class="mt-4 text-3xl font-extrabold tracking-tight sm:text-4xl">
          ìˆ  ì§€ì¶œ ì—­ì „ ê³„ì‚°ê¸°
        </h1>
        <p class="mt-2 text-slate-300">
          â€œê·¸ë•Œ ê·¸ ìˆ ê°’â€ì´ ì§€ê¸ˆ ë‚´ í†µì¥ê³¼ ì‹¸ìš°ë©´â€¦ ëˆ„ê°€ ì´ê¸¸ê¹Œ?
        </p>
      </header>

      <section
        class="glass rounded-3xl border border-white/10 p-5 shadow-xl shadow-black/20"
      >
        <div class="grid gap-4 sm:grid-cols-2">
          <div>
            <label class="text-sm text-slate-700">í•œ ë‹¬ ìˆ ìë¦¬ íšŸìˆ˜</label>
            <input
              id="sessionsPerMonth"
              type="number"
              min="0"
              step="1"
              value="6"
              class="mt-1 w-full rounded-2xl border border-slate-200 bg-white px-4 py-3 text-slate-900 outline-none focus:ring-4 focus:ring-slate-200"
            />
            <p class="mt-1 text-xs text-slate-500">ì˜ˆ: ì£¼ 1~2íšŒë©´ 4~8íšŒ</p>
          </div>

          <div>
            <label class="text-sm text-slate-700">1íšŒ í‰ê·  ì§€ì¶œ(ì›)</label>
            <input
              id="spendPerSession"
              type="number"
              min="0"
              step="1000"
              value="45000"
              class="mt-1 w-full rounded-2xl border border-slate-200 bg-white px-4 py-3 text-slate-900 outline-none focus:ring-4 focus:ring-slate-200"
            />
            <p class="mt-1 text-xs text-slate-500">
              ì˜ˆ: 3~7ë§Œì›(2ì°¨ í¬í•¨ì´ë©´ ë”)
            </p>
          </div>

          <div>
            <label class="text-sm text-slate-700"
              >ì´ íŒ¨í„´ ìœ ì§€í•œ ê¸°ê°„(ë…„)</label
            >
            <input
              id="years"
              type="number"
              min="0"
              step="0.5"
              value="3"
              class="mt-1 w-full rounded-2xl border border-slate-200 bg-white px-4 py-3 text-slate-900 outline-none focus:ring-4 focus:ring-slate-200"
            />
            <p class="mt-1 text-xs text-slate-500">ì˜ˆ: 1.5ë…„ì²˜ëŸ¼ ë°˜ë…„ë„ ê°€ëŠ¥</p>
          </div>

          <div>
            <label class="text-sm text-slate-700"
              >ì—° ìˆ˜ìµë¥ (%)
              <span class="text-xs text-slate-500">(ì„ íƒ)</span></label
            >
            <input
              id="annualRate"
              type="number"
              min="0"
              step="0.1"
              value="6"
              class="mt-1 w-full rounded-2xl border border-slate-200 bg-white px-4 py-3 text-slate-900 outline-none focus:ring-4 focus:ring-slate-200"
            />
            <p class="mt-1 text-xs text-slate-500">0%ë©´ â€œê·¸ëƒ¥ ëª¨ì•˜ë‹¤ë©´â€</p>
          </div>
        </div>

        <div class="mt-5 flex flex-col gap-3 sm:flex-row">
          <button
            id="calcBtn"
            class="w-full rounded-2xl bg-slate-900 px-5 py-3 font-semibold text-white shadow hover:opacity-95 sm:w-auto"
          >
            ê³„ì‚°í•˜ê¸°
          </button>
          <button
            id="randomBtn"
            class="w-full rounded-2xl border border-slate-200 bg-white px-5 py-3 font-semibold text-slate-900 hover:bg-slate-50 sm:w-auto"
          >
            ì˜ˆì‹œ ëœë¤
          </button>
          <button
            id="copyBtn"
            class="w-full rounded-2xl border border-white/15 bg-white/10 px-5 py-3 font-semibold text-white hover:bg-white/15 sm:ml-auto sm:w-auto"
          >
            ê²°ê³¼ ë¬¸êµ¬ ë³µì‚¬
          </button>
        </div>

        <div class="mt-6 grid gap-4 sm:grid-cols-3">
          <div class="rounded-2xl bg-white p-4 text-slate-900">
            <p class="text-xs text-slate-500">ì´ ìˆ  ì§€ì¶œ</p>
            <p id="totalSpent" class="mt-1 text-2xl font-extrabold">-</p>
            <p id="spentSub" class="mt-1 text-xs text-slate-500"></p>
          </div>
          <div class="rounded-2xl bg-white p-4 text-slate-900">
            <p class="text-xs text-slate-500">ê·¸ ëˆì„ ëª¨ì•˜ë‹¤ë©´(0%)</p>
            <p id="savedValue" class="mt-1 text-2xl font-extrabold">-</p>
            <p class="mt-1 text-xs text-slate-500">ì›ê¸ˆ ê¸°ì¤€</p>
          </div>
          <div class="rounded-2xl bg-white p-4 text-slate-900">
            <p class="text-xs text-slate-500">íˆ¬ìí–ˆë‹¤ë©´(ë³µë¦¬)</p>
            <p id="futureValue" class="mt-1 text-2xl font-extrabold">-</p>
            <p id="fvSub" class="mt-1 text-xs text-slate-500"></p>
          </div>
        </div>

        <div class="mt-4 rounded-2xl border border-white/10 bg-white/10 p-4">
          <p class="text-sm text-slate-200">ğŸ“Œ ì—­ì „ ë©˜íŠ¸</p>
          <p id="headline" class="mt-1 text-lg font-bold">ê³„ì‚°í•´ë³´ë©´ ì—¬ê¸° ëœ¸</p>
          <p id="detail" class="mt-1 text-sm text-slate-300"></p>
        </div>

        <div class="mt-4 flex flex-col gap-3 sm:flex-row sm:items-center">
          <button
            id="downloadCardBtn"
            class="w-full rounded-2xl bg-white px-5 py-3 font-semibold text-slate-900 hover:bg-slate-50 sm:w-auto"
          >
            ê²°ê³¼ ì¹´ë“œ ì´ë¯¸ì§€ ì €ì¥(PNG)
          </button>
          <p class="text-xs text-slate-400">
            * ë¸Œë¼ìš°ì €ì—ì„œ ë¡œì»¬ë¡œ ìº¡ì²˜ ìƒì„± (ì„œë²„ ë¶ˆí•„ìš”)
          </p>
        </div>

        <!-- Hidden canvas -->
        <canvas id="cardCanvas" class="hidden"></canvas>
      </section>

      <footer class="mt-10 text-center text-xs text-slate-500">
        Â© <span id="yearNow"></span> â€¢ ì¬ë¯¸ìš© ê³„ì‚° ê²°ê³¼ì´ë©° ì‹¤ì œ ì¬ë¬´ ì˜ì‚¬ê²°ì •ì˜
        ê·¼ê±°ë¡œ ì‚¬ìš©í•˜ì§€ ë§ˆì„¸ìš”.
      </footer>
    </main>

    <script>
      const $ = (id) => document.getElementById(id);

      const fmtKRW = (n) => {
        const x = Math.round(n);
        return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + "ì›";
      };

      const clampNonNeg = (v) => (isFinite(v) ? Math.max(0, v) : 0);

      // ë§¤ë‹¬ ì¼ì • ê¸ˆì•¡ì„ ë‚©ì…í•œë‹¤ê³  ê°€ì •í•œ ë¯¸ë˜ê°€ì¹˜(FV)
      // r = monthlyRate, n = months, pmt = monthlyPayment
      // FV = pmt * (( (1+r)^n - 1 ) / r)  (r=0ì´ë©´ pmt*n)
      function futureValueOfAnnuity(pmt, monthlyRate, months) {
        if (months <= 0) return 0;
        if (monthlyRate <= 0) return pmt * months;
        return pmt * ((Math.pow(1 + monthlyRate, months) - 1) / monthlyRate);
      }

      function calc() {
        const sessionsPerMonth = clampNonNeg(
          parseFloat($("sessionsPerMonth").value)
        );
        const spendPerSession = clampNonNeg(
          parseFloat($("spendPerSession").value)
        );
        const years = clampNonNeg(parseFloat($("years").value));
        const annualRatePct = clampNonNeg(parseFloat($("annualRate").value));

        const months = Math.round(years * 12);
        const monthlySpend = sessionsPerMonth * spendPerSession;
        const totalSpent = monthlySpend * months;

        const annualRate = annualRatePct / 100;
        const monthlyRate = Math.pow(1 + annualRate, 1 / 12) - 1;

        const savedValue = totalSpent; // 0%ë©´ ê·¸ëƒ¥ ìŒ“ì¸ ì›ê¸ˆ
        const fv = futureValueOfAnnuity(monthlySpend, monthlyRate, months);

        $("totalSpent").textContent = fmtKRW(totalSpent);
        $("savedValue").textContent = fmtKRW(savedValue);
        $("futureValue").textContent = fmtKRW(fv);

        $("spentSub").textContent =
          months > 0 ? `ì›” í‰ê·  ${fmtKRW(monthlySpend)} Ã— ${months}ê°œì›”` : "";
        $("fvSub").textContent = months > 0 ? `ì—° ${annualRatePct}% ê°€ì •` : "";

        const diff = fv - totalSpent;
        const diffText = diff >= 0 ? `(+${fmtKRW(diff)})` : `(${fmtKRW(diff)})`;

        // ë©˜íŠ¸ ìƒì„±
        const ratio = totalSpent > 0 ? fv / totalSpent : 0;
        let vibe;
        if (months === 0 || monthlySpend === 0) {
          vibe = "ìˆ ê°’ì´ ê±°ì˜ ì—†ë„¤â€¦ ì´ë¯¸ ìŠ¹ìì„ ğŸƒ";
        } else if (annualRatePct === 0) {
          vibe = "ë³µë¦¬ ì—†ì´ë„ ê½¤ í¼. ìˆ«ìê°€ ë‹¤ ë§í•´ì¤Œ.";
        } else if (ratio >= 1.35) {
          vibe = "ë³µë¦¬ê°€ ë¯¸ì³¤ë‹¤â€¦ ìˆ ê°’ì´ ë¯¸ë˜ë¥¼ ëš«ê³  ë‚˜ê°.";
        } else if (ratio >= 1.15) {
          vibe = "ì¡°ê¸ˆë§Œ ì¼ì° ëª¨ì•˜ì–´ë„ ê½¤ ë‹¬ë¼ì¡Œì„ ë“¯.";
        } else {
          vibe = "ìˆ˜ìµë¥  ë‚®ê²Œ ì¡ìœ¼ë©´ í˜„ì‹¤ì ìœ¼ë¡œ ì´ ì •ë„.";
        }

        const headline =
          months === 0
            ? "ê°’ì„ ì…ë ¥í•˜ë©´ ê²°ê³¼ê°€ ë‚˜ì˜µë‹ˆë‹¤."
            : `ë‚´ ìˆ ê°’ ì´ì•¡ ${fmtKRW(totalSpent)} â†’ íˆ¬ìí–ˆë‹¤ë©´ ${fmtKRW(
                fv
              )} ${diffText}`;

        const detail =
          months === 0
            ? ""
            : `ì›” ${fmtKRW(
                monthlySpend
              )}ë¥¼ ${months}ê°œì›” ë™ì•ˆ ì¼ë‹¤ê³  ê°€ì •. ${vibe}`;

        $("headline").textContent = headline;
        $("detail").textContent = detail;

        // ë³µì‚¬ìš© ë¬¸êµ¬
        const copyText = `ğŸº ìˆ  ì§€ì¶œ ì—­ì „ ê³„ì‚°ê¸° ê²°ê³¼
- ì›” ìˆ ìë¦¬: ${sessionsPerMonth}íšŒ
- 1íšŒ ì§€ì¶œ: ${fmtKRW(spendPerSession)}
- ê¸°ê°„: ${years}ë…„ (${months}ê°œì›”)
- ì´ ìˆ ê°’: ${fmtKRW(totalSpent)}
- íˆ¬ì(ì—° ${annualRatePct}% ê°€ì •): ${fmtKRW(fv)}
${headline}`;

        return {
          sessionsPerMonth,
          spendPerSession,
          years,
          months,
          annualRatePct,
          monthlySpend,
          totalSpent,
          fv,
          headline,
          detail,
          copyText,
        };
      }

      function randomExample() {
        const ex = [
          { s: 4, p: 35000, y: 2, r: 5 },
          { s: 8, p: 55000, y: 3, r: 7 },
          { s: 12, p: 65000, y: 5, r: 6 },
          { s: 2, p: 90000, y: 1.5, r: 4 },
        ][Math.floor(Math.random() * 4)];

        $("sessionsPerMonth").value = ex.s;
        $("spendPerSession").value = ex.p;
        $("years").value = ex.y;
        $("annualRate").value = ex.r;
        calc();
      }

      async function copyResult() {
        const result = calc();
        try {
          await navigator.clipboard.writeText(result.copyText);
          $("copyBtn").textContent = "ë³µì‚¬ ì™„ë£Œ!";
          setTimeout(() => ($("copyBtn").textContent = "ê²°ê³¼ ë¬¸êµ¬ ë³µì‚¬"), 900);
        } catch (e) {
          alert("ë³µì‚¬ ì‹¤íŒ¨ ğŸ˜­ ë¸Œë¼ìš°ì € ê¶Œí•œì„ í™•ì¸í•´ì¤˜.");
        }
      }

      function drawCardPNG(result) {
        const canvas = $("cardCanvas");
        const w = 1080,
          h = 1350;
        canvas.width = w;
        canvas.height = h;
        const ctx = canvas.getContext("2d");

        // ë°°ê²½ ê·¸ë¼ë°ì´ì…˜
        const g = ctx.createLinearGradient(0, 0, 0, h);
        g.addColorStop(0, "#0f172a");
        g.addColorStop(1, "#020617");
        ctx.fillStyle = g;
        ctx.fillRect(0, 0, w, h);

        // ì¹´ë“œ ì˜ì—­
        const pad = 70;
        const cardX = pad,
          cardY = pad,
          cardW = w - pad * 2,
          cardH = h - pad * 2;
        ctx.fillStyle = "rgba(255,255,255,0.08)";
        roundRect(ctx, cardX, cardY, cardW, cardH, 42, true, false);

        // í…ìŠ¤íŠ¸
        ctx.fillStyle = "#ffffff";
        ctx.font = "bold 54px system-ui, -apple-system, Segoe UI, sans-serif";
        ctx.fillText("ğŸº ìˆ  ì§€ì¶œ ì—­ì „ ê³„ì‚°ê¸°", cardX + 55, cardY + 110);

        ctx.fillStyle = "rgba(255,255,255,0.85)";
        ctx.font = "28px system-ui, -apple-system, Segoe UI, sans-serif";
        wrapText(
          ctx,
          result.headline,
          cardX + 55,
          cardY + 175,
          cardW - 110,
          42
        );

        // ìˆ˜ì¹˜ ë°•ìŠ¤ 3ê°œ
        const boxTop = cardY + 320;
        const gap = 26;
        const boxW = (cardW - gap * 2 - 110) / 3;
        const boxH = 190;
        const startX = cardX + 55;

        const boxes = [
          { t: "ì´ ìˆ  ì§€ì¶œ", v: fmtKRW(result.totalSpent) },
          { t: "ê·¸ëƒ¥ ëª¨ì•˜ë‹¤ë©´(0%)", v: fmtKRW(result.totalSpent) },
          {
            t: `íˆ¬ìí–ˆë‹¤ë©´(ì—° ${result.annualRatePct}%)`,
            v: fmtKRW(result.fv),
          },
        ];

        boxes.forEach((b, i) => {
          const x = startX + i * (boxW + gap);
          ctx.fillStyle = "rgba(255,255,255,0.10)";
          roundRect(ctx, x, boxTop, boxW, boxH, 28, true, false);

          ctx.fillStyle = "rgba(255,255,255,0.75)";
          ctx.font = "22px system-ui, -apple-system, Segoe UI, sans-serif";
          ctx.fillText(b.t, x + 26, boxTop + 50);

          ctx.fillStyle = "#ffffff";
          ctx.font = "bold 34px system-ui, -apple-system, Segoe UI, sans-serif";
          ctx.fillText(b.v, x + 26, boxTop + 105);
        });

        // ìƒì„¸
        ctx.fillStyle = "rgba(255,255,255,0.85)";
        ctx.font = "26px system-ui, -apple-system, Segoe UI, sans-serif";
        wrapText(
          ctx,
          `ì›” í‰ê·  ìˆ ê°’: ${fmtKRW(result.monthlySpend)} Â· ê¸°ê°„: ${
            result.months
          }ê°œì›”`,
          cardX + 55,
          boxTop + boxH + 80,
          cardW - 110,
          40
        );

        ctx.fillStyle = "rgba(255,255,255,0.72)";
        ctx.font = "24px system-ui, -apple-system, Segoe UI, sans-serif";
        wrapText(
          ctx,
          result.detail,
          cardX + 55,
          boxTop + boxH + 150,
          cardW - 110,
          38
        );

        // í•˜ë‹¨ ì›Œí„°ë§ˆí¬
        ctx.fillStyle = "rgba(255,255,255,0.45)";
        ctx.font = "22px system-ui, -apple-system, Segoe UI, sans-serif";
        ctx.fillText("funnyfunny.cloud", cardX + 55, cardY + cardH - 55);

        // ë‹¤ìš´ë¡œë“œ
        const url = canvas.toDataURL("image/png");
        const a = document.createElement("a");
        a.href = url;
        a.download = "alcohol-spend-card.png";
        a.click();
      }

      function roundRect(ctx, x, y, width, height, radius, fill, stroke) {
        const r =
          typeof radius === "number"
            ? { tl: radius, tr: radius, br: radius, bl: radius }
            : radius;
        ctx.beginPath();
        ctx.moveTo(x + r.tl, y);
        ctx.lineTo(x + width - r.tr, y);
        ctx.quadraticCurveTo(x + width, y, x + width, y + r.tr);
        ctx.lineTo(x + width, y + height - r.br);
        ctx.quadraticCurveTo(
          x + width,
          y + height,
          x + width - r.br,
          y + height
        );
        ctx.lineTo(x + r.bl, y + height);
        ctx.quadraticCurveTo(x, y + height, x, y + height - r.bl);
        ctx.lineTo(x, y + r.tl);
        ctx.quadraticCurveTo(x, y, x + r.tl, y);
        ctx.closePath();
        if (fill) ctx.fill();
        if (stroke) ctx.stroke();
      }

      function wrapText(ctx, text, x, y, maxWidth, lineHeight) {
        const words = String(text).split(" ");
        let line = "";
        let yy = y;
        for (let i = 0; i < words.length; i++) {
          const test = line + words[i] + " ";
          const w = ctx.measureText(test).width;
          if (w > maxWidth && i > 0) {
            ctx.fillText(line.trim(), x, yy);
            line = words[i] + " ";
            yy += lineHeight;
          } else {
            line = test;
          }
        }
        if (line.trim()) ctx.fillText(line.trim(), x, yy);
      }

      // events
      $("calcBtn").addEventListener("click", () => calc());
      $("randomBtn").addEventListener("click", () => randomExample());
      $("copyBtn").addEventListener("click", () => copyResult());
      $("downloadCardBtn").addEventListener("click", () => {
        const result = calc();
        drawCardPNG(result);
      });

      // init
      $("yearNow").textContent = new Date().getFullYear();
      calc();
    </script>
  </body>
</html>
